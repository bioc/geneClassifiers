#' UAMS70 training set
#'
#' An \code{\link{ExpressionSet}}. The data was MAS5.0 normalized to a target value of 500 and log2 transformed.
#'

"UAMS70_ExpressionSet_training"

.classifierHookList[[length(.classifierHookList)+1]]<-
function(infoOnly=TRUE,...){
    name="UAMS70"
    normalizationMethod="MAS5.0"
    description="A risk classifier for multiple myeloma"
    probeNames<-c(
        '202345_s_at','1555864_s_at','204033_at',
        '206513_at','1555274_a_at',
        '211576_s_at','204016_at','1565951_s_at','219918_s_at','201947_s_at',
        '213535_s_at','204092_s_at','213607_x_at','208117_s_at','210334_x_at',
        '204023_at','201897_s_at','216194_s_at','225834_at','238952_x_at',
        '200634_at','208931_s_at','206332_s_at','220789_s_at','218947_s_at',
        '213310_at','224523_s_at','201231_s_at','217901_at','226936_at',
        '58696_at','200916_at','201614_s_at','200966_x_at','225082_at',
        '242488_at','243011_at','201105_at','224200_s_at','222417_s_at',
        '210460_s_at','200750_s_at','206364_at','201091_s_at','203432_at',
        '221970_s_at','212533_at','213194_at','244686_at','200638_s_at',
        '205235_s_at','201921_at','227278_at','209740_s_at','227547_at',
        '225582_at','200850_s_at','213628_at','209717_at','222495_at',
        '1557277_a_at','1554736_at','218924_s_at','226954_at','202838_at',
        '230192_at','48106_at','237964_at','202729_s_at','212435_at'
    )
    weights<-c(rep(1/51,51),rep(-1/19,19))
    intercept<-0
    #means are based on the mas5 log2 data
    means<-c(
        9.19706551719161,10.8144291224041,8.02482741594127,11.2162558849659,
        8.43718493920947,7.47121611222391,6.94359447318795,7.59411129728406,
        8.61438301078837,12.1526936586961,11.6765418083989,8.95450472658377,
        8.91432869887769,9.77824697982311,7.2604415532103,10.0167147510687,
        10.097036288508,10.1419696614896,8.88506679584961,7.94951339991824,
        12.5938458056406,10.3493847078678,12.263833833485,8.05996950086986,
        9.31510293846718,8.50928269678654,10.6419330375113,12.0130149000181,
        7.69129346401523,8.79997672759112,10.2364943066668,9.58588984009275,
        9.8466235304836,12.8385021068272,10.2484465469931,7.09081971226595,
        9.01389593163794,12.2255881154544,7.94036104037506,10.3230801481447,
        11.224981241233,12.2542510748658,8.03664149238594,11.3156550278417,
        10.1236916286819,10.6061377850154,9.07108513073416,7.6369501367773,
        6.76736845900318,12.7066030077155,8.63798709271333,11.5542157220904,
        10.6568544850089,8.31607428755329,10.6142562940464,9.98547279919885,
        11.2490695936341,10.9743537880763,9.47383546773647,10.7995022960824,
        5.97008377969383,6.17442064495873,10.6465992818962,10.5252267767907,
        11.1749531135663,8.29376967784964,10.0421600832168,7.71735215523684,
        10.2405530788169,10.2900321229668
    )
    #sds are based on the mas5 log2 data
    sds<-c(
        1.73324664015633,0.39763398165076,1.14378939670517,0.91766256010483,
        0.756604692499681,1.58684159508562,1.21502520635941,1.19322363772831,
        1.76361960133134,0.544446557496476,0.464384014396926,1.01887314485952,
        0.99951858573628,0.562743066468524,1.39068276570469,0.692220226267251,
        0.941803268650604,0.703282323562713,1.1201660418788,0.90404626465626,
        0.654157071207791,0.519779441549022,0.585821384290516,1.31800408948714,
        0.367861456675213,0.702027177082244,0.516894963285626,0.639333390974159,
        2.24115378932357,0.803341226007255,0.616389890908641,1.66937928524903,
        0.833119978357664,0.624253331998359,0.418071655062988,1.35791489054738,
        1.06783052494619,1.17684941429332,0.516187997276278,0.626151947908455,
        0.616583158623723,0.732496264938867,1.00113287806509,0.488418960377633,
        0.662456898945665,0.393187136423231,1.266436553244,1.9148120406458,
        0.933336573425892,0.536455858686746,0.811635628837525,0.604367693964161,
        0.497742242845494,0.917081334352967,0.429954000157299,0.619600638296,
        0.488914867823306,0.47602844762267,0.577015223178598,0.603070350275546,
        1.31675763096059,1.12993752306183,0.788790892324437,0.363976067834321,
        0.714374599613212,0.773480456755804,0.493766794097996,0.820522431646067,
        0.960269151350048,0.493574856137756
    )
    decisionBoundaries<-0.66
    citations<-list("John D. Shaughnessy, Fenghuang Zhan, Bart E. Burington, et. al.; Blood Mar 2007, 109 (6) 2276-2284; DOI: 10.1182/blood-2006-07-038430")
    doRun=function(thisClassifier,fixedExpressionData){
        e<-exprs(fixedExpressionData)[getProbeNames(thisClassifier),]
        (t(getWeights(thisClassifier))%*%e+getIntercept(thisClassifier))[1,]
    }
    eventChain=list(
        "targetValue" = 500,
        "truncate" = -Inf,
        "allow.reweighted"=TRUE,
        "to.log"=2,
        "to.referencemeanvar"=TRUE
        )
    if(infoOnly) {
        return( c( "name"=name ,"normalizationMethod"=  normalizationMethod ,"description"=description) )
    }
    new("ClassifierParameters",
        name=name,
        description=description,
        normalizationMethod=normalizationMethod,
        weights=weights,
        intercept=intercept,
        probeNames=probeNames,
        means = means,
        sds = sds,
        decisionBoundaries=decisionBoundaries,
        doRun=doRun,
        citations = citations,
        eventChain=eventChain
    )
}
