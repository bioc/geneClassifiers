#' EMC92 training set
#'
#' An \code{\link{ExpressionSet}}. The data was MAS5.0 normalized to a target value of 500, log2 transformed, mean centered and scaled to unit variance.
#'
#' @source \url{https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE19784}
"EMC92_ExpressionSet_training"

.classifierHookList[[length(.classifierHookList)+1]]<-
function(infoOnly=TRUE,...){
    name="EMC92"
    normalizationMethod="MAS5.0"
    description="A risk classifier for multiple myeloma"
    probeNames<-c(
        '204379_s_at','210334_x_at','201795_at',
        '38158_at','201307_at','205046_at',
        '204026_s_at','238662_at','220351_at',
        '202542_s_at','243018_at','212282_at',
        '208967_s_at','225366_at','217852_s_at',
        '225601_at','231210_at','214482_at',
        '219550_at','231989_s_at','202553_s_at',
        '223811_s_at','221677_s_at','213350_at',
        '200775_s_at','217728_at','211714_x_at',
        '221755_at','AFFX-HUMISGF3A/M97935_MA_at','206204_at',
        '214612_x_at','202813_at','200875_s_at',
        '222680_s_at','233437_at','209026_x_at',
        '221606_s_at','231738_at','202322_s_at',
        '238116_at','211963_s_at','207618_s_at',
        '221826_at','218355_at','218365_s_at',
        '222713_s_at','222154_s_at','201102_s_at',
        '202884_s_at','212055_at','202107_s_at',
        '202728_s_at','239054_at','202842_s_at',
        '213002_at','208232_x_at','226742_at',
        '226218_at','217824_at','233399_x_at',
        '224009_x_at','215177_s_at','202532_s_at',
        '212788_x_at','209683_at','208942_s_at',
        '221041_s_at','226217_at','201930_at',
        '216473_x_at','217548_at','215181_at',
        '217732_s_at','201292_at','223381_at',
        '230034_x_at','213007_at','242180_at',
        '208904_s_at','214150_x_at','208732_at',
        '200701_at','208667_s_at','208747_s_at',
        '218662_s_at','201555_at','200933_x_at',
        '219510_at','228416_at','203145_at',
        '238780_s_at','201398_s_at'
    )
    weights<-c(
        0.0594273379801556,0.0174897923948543,0.00668584689209701,
        0.0423154071076169,0.0164925076573208,0.00866233731636807,
        0.00455819600852017,0.0489558593887832,0.0420452994583269,
        0.0870276088358123,0.0406887458334764,0.0529972408575157,
        0.0112796922615379,0.0140109440864371,0.00078080860374577,
        0.075000229909631,0.009265826714752,0.0860546977563988,
        0.0558748936987772,0.073011096187736,0.00538232634785429,
        0.055611094941233,0.0125985686829356,0.005608194716564,
        0.0163467078063,0.0773361612870129,0.022119958576764,
        0.0396248830654306,0.0524561174360331,0.0476703103071683,
        0.0495596844465701,0.0547508890118559,0.0437224907573062,
        0.0205354349665636,0.0445923111233813,0.025498590737044,
        0.0208131193381807,0.0685640666167821,0.0128945938676131,
        0.0660971817524709,0.0302900524131141,0.0745893468079515,
        0.0200333568025016,0.0115861932788841,0.00345861530256628,
        0.0277930303183715,0.0153863421114279,0.0349480953839344,
        0.0713507977617356,0.0384170565171902,0.0225490655109955,
        -0.110491572253885,-0.108832301005201,-0.062550086484268,
        -0.0418164824703641,-0.0493203905211073,-0.0344544706411548,
        -0.0644105573058562,-0.00414107711721288,-0.0183994540236258,
        -0.0520135932088583,-0.0767532974279582,-0.00063407777663618,
        -0.0163691988848842,-0.05606504920594,-0.0996944005531858,
        -0.0520445402963303,-0.0319185908460475,-0.00900009551662273,
        -0.0575829465263513,-0.0422745546301539,-0.0341783399437912,
        -0.0251675596648738,-0.0371869820707693,-0.0069962048640006,
        -0.0330380997958823,-0.0105781969037762,-0.0585102612125953,
        -0.0333628118834898,-0.0349253487676344,-0.0617575340318364,
        -0.0210452256979565,-0.0389953930227488,-0.0873912090180467,
        -0.0176248165093743,-0.0051520032747514,-0.0322581999457566,
        -0.00969926642147875,-0.0777964537268526,-0.00022873908620183,
        -0.0529393125922244,-0.0253569213540041
    )
    means<-c(
        5.96889007682478,6.62068561998897,11.5742591611091,8.25868305153311,
        9.57022057710511,5.1268293999711,10.3939656359443,9.44518149207568,
        6.27563497095385,11.7198494941087,6.02966462756063,10.8327831781186,
        11.0041123343548,8.76912431263642,12.8923470346941,8.46461552945742,
        6.6770920865127,7.8083581498694,5.7263075552489,6.3317326860257,
        11.5474032402825,7.70606960407318,9.62597797009185,11.976970690899,
        13.3195709956412,10.0923816060615,12.3291778853052,7.34808035348635,
        8.48537871158723,5.55104630916247,7.95109690562697,8.36984086511852,
        11.1733018211683,8.61714807269865,6.31415072309573,11.96917743168,
        7.70590148743951,7.19315055012908,10.1602529888468,4.733689358102,
        12.2881575755902,9.8026281764939,8.20491391505996,6.89486540152645,
        7.87904754493768,9.50322890768945,11.9335677668893,9.67972351565592,
        8.49670458096025,9.50513638013052,10.3259118479929,8.49174082353405,
        7.52531009552848,15.143800819755,9.89020666954177,7.12918547730944,
        12.6560237769933,7.00162830561992,13.448650578284,8.91041150513478,
        9.40420605267647,8.51783243582227,9.28162834002825,15.4474610703459,
        9.07586643677134,14.5121375889994,9.39854826180693,11.1726353042609,
        11.2337371039717,7.66143874944023,7.25719529808945,6.18429997347382,
        14.8977572104122,7.90595425030672,7.0798962702199,6.92399823499688,
        8.29312522251751,6.21700409592138,15.3946055188787,15.0940176035155,
        10.9174389247858,13.4619467787671,12.3632959279934,5.11558380321388,
        8.11118602945722,9.28408720782472,15.8472835874408,7.55098052372885,
        7.66875124786389,8.59704736997406,6.14950734686342,15.223059763865
    )
    sds<-c(
        3.56456046267517,1.21249591239816,1.29448332523982,0.758704065841749,
        1.0697979907227,1.85083695909406,1.19986364488312,0.788894759298406,
        1.5882530831192,0.497661623445149,1.40532093003955,0.961698038649451,
        0.969094492501998,0.907797448509496,0.601066380587211,1.25577072756276,
        1.50435680939411,0.960607229658687,1.6016529044967,1.30898170840826,
        0.48722799128956,1.01749130637582,0.76604901570292,1.9570945394897,
        0.593354359296585,1.84399762498661,0.90132365643273,1.885170109862,
        1.13229567736069,2.06922666177621,3.02530525000358,1.0152286924783,
        0.688155130432034,1.21405585874069,1.54432494073695,0.914799123691089,
        1.51994412794622,1.18151422668223,0.633840873727383,1.76319627531014,
        0.88175180380107,0.555960867587934,1.00309110861632,1.59682464768484,
        0.947728663345823,0.589805043403203,1.01325442209027,0.572086618173969,
        0.759331298563869,0.799636611813642,1.13994108290851,1.69301792981559,
        0.56032451804067,0.51176626990115,1.33073612348366,0.916342248622231,
        0.743352093005204,1.54943770116183,0.795928759983915,0.634940268785354,
        2.17877578990134,1.56287703279268,0.844801453378736,0.548567225212202,
        1.62522594939723,0.724777898106794,0.69633537843934,0.859956997923478,
        1.01671374251645,0.939524535358782,0.900043314159545,1.20712765123892,
        0.748001894619703,2.12817392508169,1.72748594120944,1.16551329756875,
        1.34740956168177,1.25119321134344,0.594734895560248,0.580093476643072,
        0.539547087880342,0.901620987650194,0.615442844347249,1.83760608250962,
        1.1293181355232,1.02535463113427,0.616097274438236,1.46845094861828,
        1.03135149148682,0.967384345611007,1.56595165805526,0.472873393929872
    )
    intercept<-0
    decisionBoundaries<-0.827
    citations<-list("R.Kuiper, A.Broyl, Y.de Knegt, et.al.; A gene expression signature for high-risk multiple myeloma; Leukemia (2012) 26, 2046-2413; doi:10.1038/leu.2012.127")
    doRun=function(thisClassifier,fixedExpressionData){
        e<-exprs(fixedExpressionData)[getProbeNames(thisClassifier),]
        (t(getWeights(thisClassifier))%*%e+getIntercept(thisClassifier))[1,]
    }
    eventChain=list(
        "targetValue" = 500,
        "truncate" = -Inf,
        "allow.reweighted"=TRUE,
        "to.log"=2,
        "to.meancentering"=TRUE,
        "to.unitvariance"=TRUE
        )
    if(infoOnly) {
        return( c( "name"=name ,"normalizationMethod"=  normalizationMethod ,"description"=description) )
    }
    new("ClassifierParameters",
        name=name,
        description=description,
        normalizationMethod=normalizationMethod,
        weights=weights,
        intercept=intercept,
        probeNames=probeNames,
        means = means,
        sds = sds,
        decisionBoundaries=decisionBoundaries,
        doRun=doRun,
        citations = citations,
        eventChain=eventChain
    )
}
