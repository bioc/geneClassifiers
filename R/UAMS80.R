#' UAMS80 training set
#'
#' An \code{\link{ExpressionSet}}. The data was MAS5.0 normalized to a target value of 500 and log2 transformed.
#'

"UAMS80_ExpressionSet_training"
.classifierHookList[[length(.classifierHookList)+1]]<-
function(infoOnly=TRUE,...){
    name="UAMS80"
    normalizationMethod="MAS5.0"
    description="A risk classifier for multiple myeloma"
    probeNames<-c(
        '201754_at','219110_at','201652_at','200642_at','209251_x_at',
        '200014_s_at','200039_s_at','201252_at','226924_at','225638_at',
        '235346_at','211069_s_at','202244_at','201400_at','202596_at',
        '202243_s_at','218351_at','223480_s_at','209503_s_at','212626_x_at',
        '203396_at','200882_s_at','201157_s_at','200786_at','209628_at',
        '204587_at','210460_s_at','200830_at','202690_s_at','211609_x_at',
        '218566_s_at','212296_at','217933_s_at','201114_x_at','205687_at',
        '210334_x_at','229417_at','238996_x_at','236554_x_at','229856_s_at',
        '214752_x_at','208576_s_at','202768_at','230292_at','217513_at',
        '1564423_a_at','211302_s_at','233909_at','215671_at','208869_s_at',
        '1552542_s_at','1561060_at','1557633_at','223961_s_at','202340_x_at',
        '226499_at','242548_x_at','228984_at','229388_at','1552519_at',
        '239343_at','212960_at','236986_at','223643_at','203708_at',
        '221223_x_at','213658_at','238801_at','235670_at','225582_at',
        '227524_at','239082_at','223377_x_at','216215_s_at','212050_at',
        '200673_at','223250_at','227893_at','223215_s_at','226399_at'
    )
    #means are based on the mas5 log2 data
    means<-c(
        13.3609851616866,10.8730066629585,11.1839502244337,
        13.3277810633615,13.383612082589,11.9714991034917,
        12.4265849204243,10.8373717219613,9.93667993198306,
        10.0670181028889,9.43882176021151,11.6540142589097,
        12.9571778857341,12.5008174074708,12.4902867992071,
        12.7534538157424,11.176151968456,11.6722510177413,
        11.5575657940789,12.5702305436135,12.1495455239398,
        11.779571349457,11.1291521128209,12.2206724618813,
        10.0548102465178,9.48341391549161,11.375624715959,
        11.5759416948553,11.5870438013496,11.6771396875563,
        11.1420329036808,11.956899376609,12.3664574911302,
        11.7852488429104,9.0256426461415,7.61419249104838,
        7.217776456864,9.11951054394338,8.36321467579365,
        6.56868624691987,9.38507804397211,6.06977411301201,
        10.897913910662,8.93265101873218,7.22127261798927,
        8.11995555550459,10.9131129295801,6.09928799062163,
        7.06184282077892,9.41453025421044,9.14622492551563,
        7.73131129923808,7.62639282765515,8.70133934548018,
        9.34992088163471,7.65556569147972,5.45292370410931,
        8.27954500199881,8.37562539062778,9.30546503784436,
        6.99011503795164,10.3776643730202,10.7300633811725,
        7.74421284629325,11.8274371733361,9.95003528482893,
        8.86811481968123,8.64006608746522,8.81083493649521,
        10.0582589064367,10.1312028202707,10.3119148432127,
        10.1404977138285,10.1448898957248,10.5014123824433,
        13.0716981269302,10.4425887638573,8.49661819546701,
        11.4233552149297,10.4704437166
    )
    #sds are based on the mas5 log2 data
    sds<-c(
        0.449055697669759,0.419579171703851,0.52777844847999,
        0.564607234222084,0.498934802109104,0.453724439458978,
        0.471269538580051,0.47059183009374,0.509123347622643,
        0.677589365680781,0.492441392228826,0.427095305297405,
        0.473541347924386,0.543183206572684,0.532556784030874,
        0.643792193263735,0.645137992866378,0.471325918235044,
        0.560866233940327,0.617140235323214,0.495408959692288,
        0.679177711910223,0.438124871837288,0.577281120196941,
        0.79254346910655,0.535958597724331,0.698781303823921,
        0.465336587973447,0.551245901511474,0.685362814573533,
        0.577445671018954,0.541623557655244,0.715832825803864,
        0.627370351437805,0.551796176061309,1.2865215555708,
        0.855859736950654,1.25475130942673,1.21408124124424,
        0.88195023746017,1.1458259935784,1.25843950078043,
        1.46996365370885,1.31338033146384,1.322547299151,
        0.982995929549788,1.05423554944022,1.2016263498624,
        1.1439474364264,0.832415633578691,0.988382609078946,
        0.97866934515183,0.847286398017905,1.19899298596421,
        1.42878580571618,0.857980106886257,1.18158965336575,
        1.06738372929271,0.677749325405208,0.943902779390093,
        0.783944068237874,0.896139918423895,0.91656870569806,
        0.682720746566787,0.910755466193365,0.908712857563763,
        0.637353319409808,0.810952184994969,0.641543876402551,
        0.657800856299828,0.623880054364522,0.682662645594804,
        0.844004693111632,0.691133258130851,0.446265635372098,
        0.480414787158372,0.439898660857789,0.552433333499251,
        0.48198321892677,0.438068245798283
    )
    weights<-c(rep(1/42,42),rep(-1/38,38))
    intercept<-0
    decisionBoundaries<-2.48
    citations<-list("John D. Shaughnessy, Pingping Qu, Saad Usmani, et. al.; Blood Sep 2011, 118 (13) 3512-3524; DOI: 10.1182/blood-2010-12-328252")
    doRun=function(thisClassifier,fixedExpressionData){
        e<-exprs(fixedExpressionData)[getProbeNames(thisClassifier),]
        (t(getWeights(thisClassifier))%*%e+getIntercept(thisClassifier))[1,]
    }
    eventChain=list(
        "targetValue" = 500,
        "truncate" = -Inf,
        "allow.reweighted"=TRUE,
        "to.log"=2,
        "to.referencemeanvar"=TRUE
        )
    if(infoOnly) {
        return( c( "name"=name ,"normalizationMethod"=  normalizationMethod ,"description"=description) )
    }
    new("ClassifierParameters",
        name=name,
        description=description,
        normalizationMethod=normalizationMethod,
        weights=weights,
        intercept=intercept,
        probeNames=probeNames,
        means = means,
        sds = sds,
        decisionBoundaries=decisionBoundaries,
        doRun=doRun,
        citations = citations,
        eventChain=eventChain
    )
}
