#' MILLENNIUM100 training set:
#'
#' An \code{\link{ExpressionSet}}. This is data from AffyPlus2 A and B chips which were
#' MAS5.0 normalized to a target value of 500. Afterwards they were merged together,log2
#' transformed and a scaling toward mean=0, sd=1 per probe set was applied.

"MILLENNIUM100_ExpressionSet_training"
.classifierHookList[[length(.classifierHookList)+1]]<-
function(infoOnly=TRUE,...){
    name="MILLENNIUM100"
    normalizationMethod="MAS5.0"
    description="A risk classifier for multiple myeloma based on Affy HG-U133 A/B chip"
    probeNames<-c(
        "204944_at", "210394_x_at", "225105_at",
        "204430_s_at", "227126_at", "221601_s_at", "206626_x_at", "211425_x_at",
        "210497_x_at", "211674_x_at", "218695_at", "216471_x_at", "203828_s_at",
        "226219_at", "232231_at", "225548_at", "205718_at", "221602_s_at",
        "220565_at", "209942_x_at", "218529_at", "207666_x_at", "212281_s_at",
        "223743_s_at", "241224_x_at", "225213_at", "223625_at", "227212_s_at",
        "214612_x_at", "212680_x_at", "224579_at", "225400_at", "218826_at",
        "206640_x_at", "229826_at", "212750_at", "220448_at", "208416_s_at",
        "205592_at", "223670_s_at", "210746_s_at", "201131_s_at", "227654_at",
        "211820_x_at", "205838_at", "208335_s_at", "209930_s_at", "209301_at",
        "215811_at", "205268_s_at", "232232_s_at", "223669_at", "202219_at",
        "205950_s_at", "205837_s_at", "211821_x_at", "210395_x_at", "219672_at",
        "206488_s_at", "215819_s_at", "205671_s_at", "210504_at", "216054_x_at",
        "236981_at", "226751_at", "235916_at", "204249_s_at", "205033_s_at",
        "206937_at", "242197_x_at", "210036_s_at", "210215_at", "208352_x_at",
        "210986_s_at", "217865_at", "37986_at", "200934_at", "210430_x_at",
        "214464_at", "206093_x_at", "203662_s_at", "210586_x_at", "209555_s_at",
        "215449_at", "202201_at", "206283_s_at", "221627_at", "206145_at",
        "206077_at", "205390_s_at", "205391_x_at", "208886_at","237403_at",
        "225061_at","216333_x_at","208353_x_at","213451_x_at","207087_x_at",
        "209160_at","205262_at"
    )
    #training set MAS5.0 log2 means
    means<-c(
        6.73109703826001,7.90817963565712,8.73884773652683,
        7.88365980233741,8.14378880094692,8.40667328651216,
        7.91510829135426,7.78040471259972,7.00166764557878,
        6.2255733656295,7.43134310854607,7.56190655055,
        4.90627060920899,11.1699580212811,8.70897571362713,
        7.65924215430492,9.72258374713654,6.25599000022729,
        9.63846083509491,9.3264241888553,9.0466954148829,
        6.85788487414355,9.21868518352809,9.27150187334009,
        8.11456032499162,11.0434631170675,8.03164727509703,
        9.78173548536827,8.47980503523482,9.76789707948199,
        11.024398729141,7.56464050871889,9.88533302706321,
        7.85166421021147,7.1068836421478,7.83896255661374,
        6.36284993400507,8.3230742626379,11.1395052376228,
        9.9705856715672,8.91656831332288,6.60009111281112,
        9.11024570370417,8.9335517728545,7.61064033706764,
        6.1413987752318,7.9166860843978,10.1052412004474,
        8.66065799537306,8.31456625063262,9.0085331235454,
        8.7358263985279,6.66616156844919,12.3978699256413,
        6.61899825453131,9.26488649807081,9.79471459769604,
        11.0962073104287,8.4262495239272,8.87994860267101,
        10.9042913294668,9.01816850070851,9.73610759213556,
        6.57108612627741,7.86081856713915,7.3342652544049,
        9.0700363526531,8.97858178693669,8.71797497909864,
        8.22714564634014,10.1836971513699,7.58519852910634,
        9.09788504926744,8.27077413365608,7.10482648514842,
        7.76832260787173,8.28324448879498,7.85427493221776,
        7.38012407055149,7.11657971471209,7.3770016385216,
        8.09997801156902,8.27733426212067,7.40988386597604,
        10.3895202981741,8.88107538145762,9.38671350333296,
        8.41312379750396,8.2721134709876,7.38559679149277,
        8.74596915337518,9.37479889180224,8.23321960198928,
        9.16699119604054,7.12675037481485,9.31812526387693,
        6.95370702127093,9.02506664459514,7.14356536408966,
        7.58068180043905
    )
    #training set MAS5.0 log2 sds
    sds<-c(
        2.14013629232028,1.75198803974485,1.5882745908372,
        2.47770871982515,1.85537818446984,1.31569071229897,
        2.02591010717232,1.64085506603151,1.91472491464849,
        2.70500128275246,1.36873396377102,1.65396638081027,
        1.59030472511466,0.854438233285635,2.36480526896407,
        2.08411569617768,1.98160137620441,1.36392398446161,
        1.49355831698537,2.24078303314055,1.34719372155888,
        1.85245544032877,0.786892238118157,1.34043812052829,
        1.87909477860852,0.713874800483628,1.44973870003954,
        1.05298861142825,2.28616400665031,0.731996098409766,
        0.947978359057068,1.46450073644271,0.79135702932811,
        2.17818513136806,1.8152044682713,1.73111181283633,
        2.12784873183238,1.44243702926251,1.81723745303338,
        1.75265343701827,2.41686852428671,2.07507003717621,
        1.64756210468447,2.01686357627206,2.12989846502884,
        1.51454394166854,1.78872850162798,2.19507906733008,
        0.952578902804659,1.8611873318055,1.5646854378215,
        2.12023529657555,1.98801170526506,1.93850293325436,
        2.27460237056749,2.19075823854557,1.31826760662353,
        1.685990252571,1.544369659003,1.53174150125914,
        1.6576685540298,1.29936151101882,1.20385390810285,
        1.56043464929389,1.62730668464452,1.67424632952203,
        1.52916375715361,1.50426735621414,1.51931020033612,
        1.95159341683894,1.05980951570372,1.81153224183867,
        1.46703183225273,1.1670002829267,2.20090535493238,
        1.1911085110993,1.73228210373243,1.82729582689998,
        2.13938564091624,1.39733278898812,1.46508531175789,
        1.83817626980032,1.95795067564772,1.5630700347083,
        1.34650115235277,1.29008645007067,0.928531807784087,
        1.83511695867939,1.36180902435898,1.90055174285018,
        1.76602407542288,1.58681422888894,1.83941440855529,
        1.81503210156952,1.46717048823844,1.44228915452052,
        1.52366368349099,1.47410958989592,1.88109447968467,
        1.75253900988224
    )
    weights<- c(3.05, 2.96, 2.94, 2.90, 2.87, 2.85, 2.82, 2.80, 2.76, 2.66,
        2.63, 2.61, 2.58, 2.57, 2.55, 2.52, 2.52, 2.51, 2.50, 2.48,
        2.47, 2.46, 2.45, 2.45, 2.42, 2.40, 2.39, 2.37, 2.34, 2.34,
        2.33, 2.33, 2.32, 2.32, 2.31, 2.29, 2.28,-2.29,-2.30,-2.30,
        -2.35,-2.35,-2.35,-2.36,-2.36,-2.37,-2.37,-2.37,-2.38,-2.38,
        -2.39,-2.39,-2.40,-2.40,-2.42,-2.42,-2.43,-2.44,-2.47,-2.47,
        -2.47,-2.48,-2.49,-2.49,-2.50,-2.52,-2.52,-2.53,-2.53,-2.54,
        -2.55,-2.55,-2.56,-2.57,-2.57,-2.61,-2.61,-2.61,-2.62,-2.64,
        -2.65,-2.67,-2.68,-2.69,-2.69,-2.69,-2.70,-2.72,-2.74,-2.77,
        -2.78,-2.79,-2.82,-2.88,-2.88,-2.91,-2.96,-2.97,-3.07,-3.22)
    intercept<-0
    decisionBoundaries<-0.5
    citations<-list("G. Mulligan, C. Mitsiades, B. BryantGene, et al.; Expression profiling and correlation with outcome in clinical trials of the proteasome inhibitor bortezomib; Blood Apr 2007, 109 (8) 3177-3188; DOI: 10.1182/blood-2006-09-044974")
    doRun=function(thisClassifier,fixedExpressionData){
        e<-exprs(fixedExpressionData)[getProbeNames(thisClassifier),]
        (t(getWeights(thisClassifier))%*%e+getIntercept(thisClassifier))[1,]
    }
    eventChain=list(
        "targetValue" = 500,
        "truncate" = -Inf,
        "allow.reweighted"=TRUE,
        "to.log"=2,
        "to.meancentering"=TRUE,
        "to.unitvariance"=TRUE
    )
    if(infoOnly) {
        return( c( "name"=name ,"normalizationMethod"=  normalizationMethod ,"description"=description) )
    }
    new("ClassifierParameters",
        name=name,
        description=description,
        normalizationMethod=normalizationMethod,
        weights=weights,
        intercept=intercept,
        probeNames=probeNames,
        means = means,
        sds = sds,
        decisionBoundaries=decisionBoundaries,
        doRun=doRun,
        citations = citations,
        eventChain=eventChain
    )
}
